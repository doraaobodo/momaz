% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_simulations.R
\name{sim.metaZ}
\alias{sim.metaZ}
\title{Single-setting simulation with cwMCD evaluation}
\usage{
sim.metaZ(
  r = 100,
  m = 1000,
  d = 5,
  perout = 0.05,
  farout = 0.5,
  outlierType = "casewise",
  corrType = "ALYZ",
  u = 0:10000/10000,
  seed = NULL
)
}
\arguments{
\item{r}{Integer. Number of simulation replicates (default \code{100}).}

\item{m}{Integer. Number of markers (rows / observations) per replicate (default \code{1000}).}

\item{d}{Integer. Dimension (number of variables) (default \code{5}).}

\item{perout}{Numeric in [0,1]. Proportion of outliers (default \code{0.05}).}

\item{farout}{Numeric. Magnitude/severity of outliers (default \code{0.5}).}

\item{outlierType}{Character. One of \code{"casewise"}, \code{"cellwiseStructured"}, or \code{"both"} (default \code{"casewise"}).}

\item{corrType}{Character. Correlation structure for \code{\link[cellWise]{generateCorMat}}
(default \code{"ALYZ"}). Use \code{"independent"} for identity covariance.}

\item{u}{Numeric vector in [0,1] giving the EDF grid for ROC curve interpolation
(default \code{0:10000/10000}).}

\item{seed}{Optional integer. Initial random seed (default \code{NULL}).}
}
\value{
A list with:
\describe{
\item{auc}{Named numeric vector of mean AUCs across replicates (one per criterion).}
\item{roc.mtx}{Matrix with columns \code{lvl} (EDF grid) and per-criterion mean ROC ordinates.}
\item{pm}{The last replicate's performance matrix (includes attributes \code{auc}).}
\item{S}{The covariance matrix used.}
\item{m, d, perout, farout, outlierType, seed}{Input parameters echoed back.}
}
}
\description{
Simulates data under a chosen correlation structure and outlier mechanism,
applies \code{\link[=cwMCD]{cwMCD()}} to each replicate, builds ROC curves (via EDF grid \code{u}),
and averages AUCs/ROCs over \code{r} replicates.
}
\details{
The covariance matrix \code{S} is formed by \code{\link[cellWise]{generateCorMat}} unless
\code{corrType == "independent"}, in which case \code{S = I_d}. Data are simulated by
\code{\link[cellWise]{generateData}}.
}
\examples{
\dontrun{
set.seed(123)
res = sim.metaZ(r = 3, m = 300, d = 4, perout = 0.05, farout = 0.5,
                 outlierType = "both", corrType = "A09",
                 u = seq(0, 1, length.out = 51), seed = 42)
names(res$auc)
}

}
